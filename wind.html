<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>气象风羽图—地听测试</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />

    <style>
        body {
            padding: 0;
            margin: 0;
        }
        
        html,
        body,
        #map {
            height: 100%;
            width: 100%;
        }
    </style>

</head>

<body>
    <div id="map"></div>
</body>

<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
<script src="leaflet-windbarb.js"></script>

<script>
    var map = L.map('map', {
        center: [31, 121],
        zoom: 4
    });

    L.tileLayer('https://geohey.com/s/mapping/{mapId}/all?z={z}&x={x}&y={y}&retina=@2x&ak=YmUwODYyOThhYTQ1NGFmYmE4ZjI0MDhkMDFjNTUwYjQ', {

        attribution: 'GeoHey &copy;',
        maxZoom: 18,
        mapId: 'light'

    }).addTo(map);


    var meteoPoints=[
        [31,121,14,0],
        [31,121,26,40],
        [33,130,10,120]
    ];

    meteoPoints.forEach(function(p){
        var icon = L.WindBarb.icon({deg: p[3], speed: p[2]});
        var marker = L.marker([p[0],p[1]], {icon: icon}).addTo(map).bindPopup("<p>风速: "+p[2]+"</p>"+
            "<p>风向: "+p[3]+"</p>");
    });


    meteoPoints=[
        [21,121,14,0],
        [21,121,26,90],
        [23,130,10,45]
    ];

    meteoPoints.forEach(function(p){
        var icon = L.WindBarb.icon({deg: p[3], speed: p[2],pointRadius:0,strokeColor:'#ce3431'});
        var marker = L.marker([p[0],p[1]], {icon: icon}).addTo(map).on('click', markerOnClick);
        marker.dataAttributes=p;
    });

    function markerOnClick(e){
        var item = this.dataAttributes;
        console.log(item[2]+item[3]);
    }


</script>

</html>